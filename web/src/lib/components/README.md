# components/

Svelte компоненты UI.

## Компоненты

### LeafletMap.svelte

Интерактивная карта на базе Leaflet.

**Функции:**
- Отображение тайлов текущего этажа
- Рендер маркеров (иконки + текстовые метки)
- Зум и перетаскивание
- Клик по маркеру → выбор
- Автоматическое центрирование на выбранном маркере

**Реактивные зависимости:**
- `$mapData` → обновление границ карты
- `$currentFloor` → смена слоя тайлов
- `$currentFloorMarkers` → перерисовка маркеров
- `$selectedMarker` → панорамирование к маркеру

**Тайлы:**
```
/tiles/{mapId}/floor{n}/{z}/{x}/{y}.webp
```

---

### FloorSwitch.svelte

Переключатель этажей (вертикальные кнопки).

```
┌────┐
│ ▲  │  Этаж выше (disabled если максимум)
├────┤
│ 2  │  Текущий этаж
├────┤
│ ▼  │  Этаж ниже (disabled если 1)
└────┘
```

**Props:** нет (использует stores напрямую)

**Stores:**
- `currentFloor` — текущий этаж (read/write)
- `maxFloor` — максимальный этаж (read)

---

### SearchBar.svelte

Поисковая строка с результатами.

**Состояния:**
1. **Свёрнуто** — показывает placeholder с названием карты
2. **Развёрнуто** — поле ввода + список результатов

**Функции:**
- Поиск по названию/номеру комнаты
- Отображение результатов с этажом
- Клик по результату → переход на этаж + выбор маркера
- Backdrop для закрытия

**Stores:**
- `searchQuery` — текст запроса
- `searchExpanded` — развёрнут ли поиск
- `mapTitle` — название карты для placeholder

---

### MarkerPopup.svelte

Popup с информацией о выбранном маркере.

```
┌─────────────────────────────────────┐
│ [icon]  Название маркера        [x] │
│         Расположение                │
│                                     │
│ Описание маркера (если есть)        │
│                                     │
│ Тип маркера          Этаж 2         │
└─────────────────────────────────────┘
```

**Анимация:** slide-up при появлении

**Stores:**
- `selectedMarker` — выбранный маркер (null = скрыт)
- `language` — язык для текста

---

## Стилизация

Все компоненты используют CSS переменные из `styles/global.css`:

```css
--primary, --on-primary
--surface, --on-surface
--surface-variant, --on-surface-variant
--outline, --outline-variant
--default-padding
--border-radius
--shadow-md
```

Поддержка тёмной темы через `@media (prefers-color-scheme: dark)`.
